# **201903-3** 损坏的RAID5 30/100

```c++
#include<iostream>
#include<stack>
#include<vector>
#include<unordered_map>
using namespace std;
const int maxN=1e3+5;
int n,s,l;
char nor_c[300][300];
unordered_map<char,int> c_i;
unordered_map<int,char> i_c;
string disk[maxN]={""};
int get_p_row(int col){
    return n-1-col%n;
}
void get_strap_pos(int x,int &row,int &col){
    x/=s;
    row=x/n;
    col=x%n;
    if(row>=get_p_row(col))row++;
    //cout<<row<<" "<<col<<endl;
}
string get_content(int disk_num,int strap_num,int block_num){
    if(strap_num*s*8+block_num*8+8>(int)disk[disk_num].size())return "";
    return disk[disk_num].substr(strap_num*s*8+block_num*8,8);
}
char c_nor_c(char c1,char c2){
    int x1,x2;
    if(isalpha(c1)){
        x1=c1-'A'+10;
    }else{
        x1=c1-'0';
    }
    if(isalpha(c2)){
        x2=c2-'A'+10;
    }else{
        x2=c2-'0';
    }
    x1^=x2;
    if(x1<10)return (char)(x1+'0');
    else return (char)(x1-10+'A');
}
void s_nor_s(string &s1,string &s2){
    for(int i=0;i<s1.size();i++){
        s1[i]=nor_c[s1[i]][s2[i]];
    }
}
int main(){
    //cout<<s_nor_s("14151617","B4B5B6B7");
    for(int i='0';i<='9';i++){
        c_i[i]=i-'0';
        i_c[c_i[i]]=i;
    }
    for(int i='A';i<='F';i++){
        c_i[i]=i-'A'+10;
        i_c[c_i[i]]=i;
    }
    for(int i=0;i<16;i++){
        for(int j=0;j<16;j++){
            nor_c[i_c[i]][i_c[j]]=i_c[i^j];
        }
    }
    scanf("%d %d %d",&n,&s,&l);
    int x;
    for(int i=0;i<l;i++){
        scanf("%d",&x);
        cin>>disk[x];
    }
    int m;
    cin>>m;
    for(int i=0;i<m;i++){
        scanf("%d",&x);
        int r,c;
        get_strap_pos(x,r,c);
        string cont=get_content(c,r,x%s);
        if(cont!=""){
            cout<<cont<<endl;
        }else if(n-l>1){
            cout<<"-"<<endl;
        }else{
            vector<string> v;
            for(int j=0;j<n;j++){
                cont=get_content(j,r,x%s);
                if(cont!="")v.push_back(cont);
            }
            if(v.size()<n-1){
                cout<<"-"<<endl;
                continue;
            }
            string ans=v[0];
            for(int j=1;j<v.size();j++){
                //cout<<ans<<endl;
                s_nor_s(ans,v[j]);
            }
            cout<<ans<<endl;
        }
    }
    return 0;
}
/*
3 2 2
0 000102030405060710111213141516172021222324252627
1 A0A1A2A3A4A5A6A7B0B1B2B3B4B5B6B7C0C1C2C3C4C5C6C7
*/

```

```
#include<iostream>
#include<stack>
#include<vector>
#include<unordered_map>
#include<stdio.h>
using namespace std;
const int maxN=1e3+5;
const int maxL=1e5+5;
int n,s,l;
char nor_c[300][300];
unordered_map<char,int> c_i;
unordered_map<int,char> i_c;
char disk[maxN][maxL]={""};
int get_p_row(int col){
    return n-1-col%n;
}
void get_strap_pos(int x,int &row,int &col){
    x/=s;
    row=x/n;
    col=x%n;
    if(row>=get_p_row(col))row++;
    //cout<<row<<" "<<col<<endl;
}
char* get_content(int disk_num,int strap_num,int block_num){
    if(strap_num*s*8+block_num*8+8>(int)strlen(disk[disk_num]))return NULL;
    return &disk[disk_num][strap_num*s*8+block_num*8];
}
char c_nor_c(char c1,char c2){
    int x1,x2;
    if(isalpha(c1)){
        x1=c1-'A'+10;
    }else{
        x1=c1-'0';
    }
    if(isalpha(c2)){
        x2=c2-'A'+10;
    }else{
        x2=c2-'0';
    }
    x1^=x2;
    if(x1<10)return (char)(x1+'0');
    else return (char)(x1-10+'A');
}
void s_nor_s(char *&s1,char* &s2){
    for(int i=0;i<8;i++){
        s1[i]=nor_c[s1[i]][s2[i]];
    }
}
int main(){
    //cout<<s_nor_s("14151617","B4B5B6B7");
    for(int i='0';i<='9';i++){
        c_i[i]=i-'0';
        i_c[c_i[i]]=i;
    }
    for(int i='A';i<='F';i++){
        c_i[i]=i-'A'+10;
        i_c[c_i[i]]=i;
    }
    for(int i=0;i<16;i++){
        for(int j=0;j<16;j++){
            nor_c[i_c[i]][i_c[j]]=i_c[i^j];
        }
    }
    scanf("%d %d %d",&n,&s,&l);
    int x;
    for(int i=0;i<l;i++){
        scanf("%d",&x);
        fgets(disk[x],maxL,stdin);
    }
    int m;
    cin>>m;
    for(int i=0;i<m;i++){
        scanf("%d",&x);
        int r,c;
        get_strap_pos(x,r,c);
        char * cont=get_content(c,r,x%s);
        if(cont!=NULL){
            cout<<cont<<endl;
        }else if(n-l>1){
            cout<<"-"<<endl;
        }else{
            vector<char *> v;
            for(int j=0;j<n;j++){
                cont=get_content(j,r,x%s);
                if(cont!=NULL)v.push_back(cont);
            }
            if(v.size()<n-1){
                cout<<"-"<<endl;
                continue;
            }
            char* ans=v[0];
            for(int j=1;j<v.size();j++){
                //cout<<ans<<endl;
                s_nor_s(ans,v[j]);
            }
            for(int j=0;j<8;j++){
                printf("%c",ans[j]);
            }
            printf("\n");
        }
    }
    return 0;
}
/*
 3 2 2
 0 000102030405060710111213141516172021222324252627
 1 A0A1A2A3A4A5A6A7B0B1B2B3B4B5B6B7C0C1C2C3C4C5C6C7
 */
```

